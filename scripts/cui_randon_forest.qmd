---
title: "cui_rf"
author: "christina"
format: html
editor: visual
---

```{r}
library(tidyverse)
library(dplyr)
library(tidymodels)
library(readr)
library(glmnet)
library(randomForest)
library(tidytext)
library(keras3)
library(caret)
library(tensorflow)
library(tokenizers)
library(textstem)
library(stopwords)
library(sparsesvd)
library(Matrix)

```

```{r}
load("~/Desktop/UCSB/Statistics & Data Science/PSTAT 197/module-2-group13/data/claims-clean-example.RData")

```

```{r}
set.seed(188)
trainIndex <- createDataPartition(data$label, p = 0.8, list = FALSE)
trainData <- data[trainIndex, ]
testData <- data[-trainIndex, ]

```

```{r}
rf_model <- randomForest(
  label ~ .,  # Replace `label` with the actual column name for the target variable
  data = trainData,
  ntree = 500,    # Number of trees
  mtry = 2,       # Number of features to sample (adjust based on dataset)
  importance = TRUE
)

```

```{r}
predictions <- predict(rf_model, newdata = testData)
confusionMatrix(predictions, testData$label)  # Replace `label` as appropriate

```

```{r}
pred_df <- data.frame(
  .id = testData$.id,         # Replace with the appropriate ID column
  bclass.pred = predictions,  # For binary classification
  mclass.pred = predictions   # For multiclass (adjust as needed)
)
save(pred_df, file = "results/preds-rf.RData")

```

```{r}
importance(rf_model)
varImpPlot(rf_model)

```

